\documentclass[10pt]{academydoc}
\pagestyle{plain}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{seqsplit}
\usepackage{draftwatermark}
\usepackage{csvsimple}
\usepackage{siunitx}
\usepackage{lipsum}
\usepackage{xstring}
\usepackage{newtxmath}

% A few useful global macros
\newcommand{\whitepoint}[1]{%
    \IfEqCase{#1}{%
        {aces}{CIE $x{=}0.32168$ $y{=}0.33767$}%
        {d65}{CIE $x{=}0.3127$ $y{=}0.3290$}%
        {dci}{CIE $x{=}0.3140$ $y{=}0.3510$}%
    }[\PackageError{whitepoint}{Undefined option to whitepoint: #1}{}]%
}%

\newcommand{\rgbequal}[1]{%
    $R{=}G{=}B$%
    \ignorespaces
}%

\newcommand{\rgbequalone}[1]{%
    $R{=}G{=}B{=}1.0$%
    \ignorespaces
}%

\newcommand{\nits}[1]{
	\SI[per-mode=symbol]{#1}{\candela\per\meter\squared}%
	\ignorespaces
}

\newcommand{\transformID}[1]{%
    \IfEqCase{#1}{%
        {p3dci}{\texttt{\seqsplit{ODT.Academy.P3DCI\_48nits.a1.0.3}%
        \ignorespaces}}%
        {p3d60}{\texttt{\seqsplit{ODT.Academy.P3D60\_48nits.a1.0.3}%
        \ignorespaces}}%
        {dcdm}{\texttt{\seqsplit{ODT.Academy.DCDM.a1.0.3}%
        \ignorespaces}}%
        {dcdmP3clip}{\texttt{\seqsplit{ODT.Academy.DCDM\_P3D60.a1.0.3}%
        \ignorespaces}}%
        {rec709_d60sim}{\texttt{\seqsplit{ODT.Academy.Rec709\_D60sim\_100nits\_dim.a1.0.3}%
        \ignorespaces}}%
        {rec709}{\texttt{\seqsplit{ODT.Academy.Rec709\_100nits\_dim.a1.0.3}%
        \ignorespaces}}%
        {rec2020_100nit}{\texttt{\seqsplit{ODT.Academy.Rec2020\_100nits\_dim.a1.0.3}%
        \ignorespaces}}%
        {p3d60_1000nit}{\texttt{\seqsplit{ODT.Academy.P3D60\_ST2084\_1000nits.a1.0.3}%
        \ignorespaces}}%
        {p3d60_2000nit}{\texttt{\seqsplit{ODT.Academy.P3D60\_ST2084\_2000nits.a1.0.3}%
        \ignorespaces}}%
        {p3d60_4000nit}{\texttt{\seqsplit{ODT.Academy.P3D60\_ST2084\_4000nits.a1.0.3}%
        \ignorespaces}}%
        {rec2020_1000nit}{\texttt{\seqsplit{ODT.Academy.Rec2020\_ST2084\_1000nits.a1.0.3}%
        \ignorespaces}}%
        {rgbMonitor}{\texttt{\seqsplit{ODT.Academy.RGBmonitor\_100nits\_dim.a1.0.3}%
        \ignorespaces}}%
        {rgbMonitorD60sim}{\texttt{\seqsplit{ODT.Academy.RGBmonitor\_D60sim\_100nits\_dim.a1.0.3}%
        \ignorespaces}}%
    }[\PackageError{transformID}{Undefined option to transformID: #1}{}]%
}%

\newcommand{\shortName}[1]{%
    \IfEqCase{#1}{%
        {p3dci}{{ACES 1.0 Output - P3-DCI}%
        \ignorespaces}%
        {p3d60}{{ACES 1.0 Output - P3-D60}%
        \ignorespaces}%
        {dcdm}{{ACES 1.0 Output - DCDM}%
        \ignorespaces}%
        {dcdmP3clip}{{ACES 1.0 Output - DCDM (P3 gamut clip)}%
        \ignorespaces}%
        {rec709_d60sim}{{ACES 1.0 Output - Rec.709 (D60 sim.)}%
        \ignorespaces}%
        {rec709}{{ACES 1.0 Output - Rec.709}%
        \ignorespaces}%
        {rec2020_100nit}{{ACES 1.0 Output - Rec.2020}%
        \ignorespaces}%
        {p3d60_1000nit}{{ACES 1.0 Output - P3-D60 ST2084 (1000 nits)}%
        \ignorespaces}%
        {p3d60_2000nit}{{ACES 1.0 Output - P3-D60 ST2084 (2000 nits)}%
        \ignorespaces}%
        {p3d60_4000nit}{{ACES 1.0 Output - P3-D60 ST2084 (4000 nits)}%
        \ignorespaces}%
        {rec2020_1000nit}{{ACES 1.0 Output - Rec.2020 ST2084 (1000 nits)}%
        \ignorespaces}%
        {rgbMonitor}{{ACES 1.0 Output - sRGB}%
        \ignorespaces}%
        {rgbMonitorD60sim}{{ACES 1.0 Output - sRGB (D60 sim)}%
        \ignorespaces}%
    }[\PackageError{shortName}{Undefined option to shortName: #1}{}]%
}%

% Transform ID table macro
\newcommand{\idTable}[2]{
	\begin{table}[ht!]
	    \centering
	    \begin{tabular}{|p{#1in}|p{#2in}|}
	        \hline
	        \textbf{Simple Name} & \textbf{TransformID} \\ \hline
	        \shortName{\id} & \transformID{\id} \\ \hline
	    \end{tabular}
	    \caption{Transform Identifiers: \protect\shortName{\id}}
	    \label{tab:odt-ident-\id}
	\end{table}
}

% Screenshot figures macro
\newcommand{\odtScreenshots}[1]{
    \begin{figure*}[ht!]
        \centering
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/aces}
            \caption{Original ACES Image}   
            \label{fig:acesSource-\id}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.475\textwidth}  
            \centering 
            \includegraphics[width=\textwidth]{images/\id/\id _histogram}
            \caption{Histogram}    
            \label{fig:hist-\id}
        \end{subfigure}
        \vskip\baselineskip
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{images/\id/\id _parade}
            \caption{Parade}   
            \label{fig:parade-\id}
        \end{subfigure}
        \quad
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{images/\id/\id _waveform}
            \caption{Waveform}   
            \label{fig:wf-\id}
        \end{subfigure}
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{images/\id/\id _vectorscope}
            \caption{Vectorscope}  
            \label{fig:vect-\id}
        \end{subfigure}
        \quad
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{images/\id/\id _image}
            \caption{#1}  
            \label{fig:cv-\id}
        \end{subfigure}
        \caption{Scope Screenshots} 
        \label{fig:screenshots-\id}
    \end{figure*}
}

% Test Values Table Macro
\newcommand{\testValuesTable}{
	\begin{table}[ht!]
	        \begin{tabular}{|>{\bfseries\arraybackslash}c|}
	            \hline
	            Patch\\
	            \hline
	            N1\\\hline
	            N2\\\hline
	            N3\\\hline
	            R\\ \hline
	            G\\ \hline
	            B\\ \hline
	            C\\ \hline
	            M\\ \hline
	            Y\\ 
	            \hline
	        \end{tabular}%
	        \csvloop{file=./secs-odtDetails/test_values/test_values_\id.csv, no head, 
	            before reading=\centering,
	            tabular={c@{}*8{S[table-format=1.4]|}S[table-format=2.4]|},
	            table head=\hline & \multicolumn{3}{c|}{\textbf{ACES RGB}} & \multicolumn{3}{c|}{\textbf{Display RGB}} & \multicolumn{3}{c|}{\textbf{Display xyY}}\\
	            \hline, 
	            command=&\csvcoli & \csvcolii & \csvcoliii & \csvcoliv & \csvcolv & \csvcolvi & \csvcolvii & \csvcolviii & \csvcolix,
	            late after line=\\\hline}
	        \caption{Test Values: \protect\shortName{\id}}
			\label{tab:testValues-\id}
	\end{table}
}

% Test Values Sub-Section Macro
\newcommand{\testValuesSubSec}{	
	Table \ref{tab:testValues-\id} contains test values can be used to confirm the proper monitor setup and ODT combination.  Each of the 9 ACES RGB input values should yield the RGB noted display RGB code values (normalized 0-1, full range) when processed through the \transformID{\id}. When driving a properly setup display with the noted display RGB code values, the light from the display should measure with the noted CIE xyY colorimetry.  
	
	If the display RGB code values do not match those in the table when using the corresponding input ACES RGB code values, it is likely the wrong ODT is being used.  If the proper display RGB code values are being produced by the ODT, but he measured display colorimetry doesn't match the display xyY code values noted, it is likely the display setup is incorrect.
	
	\testValuesTable{}
}

% Set Document Details
\doctype{tb} % spec, proc, tb (Specification, Procedure, Technical Bulletin)
\docname{ACES Output Transform User Guide}
\altdocname{ACES Output Transform User Guide}

% Sets the document name used in header - usually an abbreviated document title
\docnumber{TB-2017-00x}
\committeename{Academy Color Encoding System (ACES) Project Committee}
\docdate{November 26, 2017}
\summary{ The Academy Color Encoding System (ACES) includes a variety of Output Transforms intended to support a wide range of display devices.  These devices include standard dynamic range digital cinema projectors, broadcast monitors, computer desktop displays, and high dynamic range displays.  Each of these devices may be configured differently and requires an ACES output transforms be used based on the specifics of the configuration.  This document is intended to be practical guide help end-users determine the proper ACES output transform to be used based on their devices, configurations, and workflows.
}

% Sets the document "DRAFT" watermark
\SetWatermarkLightness{0.95}
\SetWatermarkScale{1}

% Document Starts Here
\begin{document}

\maketitle

\input{notices} \newpage
\input{histanddocs} \newpage

\tableofcontents \newpage

\input{introduction} \newpage
\input{references} \newpage

\input{workflows} \newpage
\input{details}

\end{document}